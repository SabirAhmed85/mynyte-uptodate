!function(){MynyteApi=function(){function e(){v=!0}function t(){v=!1}function n(){var e=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop],t=jQuery("html");t.data("scroll-position",e),t.data("previous-overflow",t.css("overflow")),t.css("overflow","hidden"),window.scrollTo(e[0],e[1])}function s(){var e=jQuery("html"),t=e.data("scroll-position");e.css("overflow",e.data("previous-overflow")),window.scrollTo(t[0],t[1])}function i(e,t){var a=document.getElementsByTagName("head")[0],n=document.createElement("script");n.src=e,n.type="text/javascript",n.onload=n.onreadystatechange=function(){n.readyState?"complete"!==n.readyState&&"loaded"!==n.readyState||(n.onreadystatechange=null,t()):t()},a.appendChild(n)}function o(e){var t=e.className,a=e.action,n=e.data||null,s=e.existingVars||null,i=e.successCallback||function(){},o=e.errorCallback||function(){};$.ajax({url:A+"/"+current_db_environment_file_url+"sneak-preview/data/extApi/"+t+".php?action="+a,type:"GET",dataType:"jsonp",jsonp:"jsonp",jsonpCallback:a,context:self,crossDomain:!0,data:n,success:function(e){i({successData:e,existingVars:s})},error:function(e,t,a){o(a)},complete:function(e){}})}function l(e){var t=e.className,a=e.action,n=e.data||null,s=e.existingVars||null,i=e.successCallback||function(){},o=e.errorCallback||function(){},l={uploadImage:{type:"POST",cache:!1,processData:!1,async:!1}};console.log(e,MynyteApi.pageVars["New Business Item Forms"][0].internalDataUrl),console.log(a),$.ajax({url:MynyteApi.pageVars["New Business Item Forms"][0].internalDataUrl+"/"+t+".php?action="+a,type:l[a].type,dataType:"json",context:self,async:l[a].async,data:n,cache:l[a].cache,processData:l[a].processData,contentType:!1,success:function(e){i({successData:e,existingVars:s})},error:function(e,t,a){o(a)},complete:function(e){}})}function r(e){var t="";if(e.class=e.class?" "+e.class:"",0==$(".mynyte-popup-cover").length){$("<div/>").appendTo($("body")).attr("class","mynyte-popup-cover")}" menu-item-detail"==e.class&&(t='<div class="mynyte-popup'+e.class+'">',t+='<div class="mn-popup-header">',t+='<h4 class="menu-item-title"></h4>',t+='<i class="fa fa-times mn-popup-close" onclick="MynyteApi.closePopup({});"></i>',t+="</div>",t+='<div class="mn-popup-body">',t+='<img src="#" alt=""/>',t+='<p class="menu-item-description">',t+="</div>",t+="</div>"),$(".mynyte-popup-cover").append(t)}function m(t){var a="fast"==t.speed?1:250;if(n(),e(),navigator.userAgent.match(/(iP(od|hone|ad))/)){var s=document.body.scrollTop;document.body.style.top=-1*s+"px",document.body.classList.add("mn-modal--opened")}window.setTimeout(function(){$(".mynyte-popup-cover").addClass("mynyte-popup-open")},a),t.onComplete&&t.onComplete()}function p(e){if($(".mynyte-popup-cover").removeClass("mynyte-popup-open"),s(),t(),navigator.userAgent.match(/(iP(od|hone|ad))/)){var a=parseInt(document.body.style.top,10);document.body.classList.remove("mn-modal--opened"),document.body.scrollTop=-1*a}}function c(e){function t(t){function n(e){console.log(e),$(".mn-listings-inner-container").each(function(t){$(this).removeClass("show"),$(this).data("mn-listing-type")==e&&$(this).addClass("show")}),$(".mn-listings-nav-listing").each(function(t){$(this).removeClass("active"),$(this).data("mn-nav-label-type")==e&&$(this).addClass("active")}),$(".mynyte-listings .more-listings-note").each(function(t){$(this).removeClass("show"),$(this).data("mn-listing-type")==e&&$(this).addClass("show")})}function s(){function e(e){console.log(e),window.open(e)}MynyteApi.goToFeedOption=function(t,a){t.preventDefault(),e(a)};for(var t=Object.keys(l.items),n=0,s=t.length;n<s;n++){var o=t[n],p=l.items[o],y=0==n?" show":"",d=p[0].listingTypeName,u=0==n?" show":"",g={href:w+"searchRestaurantsByFoodStyle//",text:"See more "+d+"s on MyNyte",title:"See more "+d+"s on MyNyte"};for(g.html="<div data-mn-listing-type='"+d+"' class='more-listings-note"+u+"'><a href='"+g.href+"' title='"+g.title+"'>"+g.text+"</a></div>",m+="<div data-mn-listing-type='"+o+"' class='mn-listings-inner-container trans"+y+"'>",a=0;a<p.length;a++){var f="small"==r?" with-small-image":"",h=p[a].name.replace(/ /g,"%20"),v="Event"==p[a].listingTypeName&&"default.jpg"!=p[a].currentCoverPhotoName?"https://www.mynyte.co.uk/"+x+"sneak-preview/img/user_images/cover_photo/"+p[a].currentCoverPhotoName:"https://www.mynyte.co.uk/"+x+"sneak-preview/img/user_images/profile_photo/"+p[a].currentProfilePhotoName,b="Event"==p[a].listingTypeName||"Movie"==p[a].listingTypeName||"Offer"==p[a].listingTypeName?"https://www.mynyte.co.uk/"+N+"#/app/feed/nl-feedListings///nl-feedListing/"+p[a].relListingId+"/"+p[a].listingTypeName:"https://www.mynyte.co.uk/"+N+"#/app/feed/nl-feedListings///nl-feedListing/"+p[a].relListingId+"/Business",w="https://www.mynyte.co.uk/"+N+"#/app/feed/nl-feedListings/",I=b.replace("/feed/","/"),k=I+"/"+h+"/nl-feedListing-photos/"+p[a]._listingId;b="Event"==p[a].listingTypeName||"Movie"==p[a].listingTypeName?"https://www.mynyte.co.uk/"+N+"#/app/feed/nl-feedListings///nl-feedListing/"+p[a].relListingId+"/"+p[a].listingTypeName:b,I=b.replace("/feed/","/"),"See A la Carte Menu"==p[a].tonightsFeedButtonOptionName?k=I+"/see-menu/"+p[a].relListingId+"/"+h+"/2":"See Takeaway Menu"==p[a].tonightsFeedButtonOptionName?k=I+"/see-menu/"+p[a].relListingId+"/"+h+"/1":"Book Table"==p[a].tonightsFeedButtonOptionName?(p[a].showUsersEmailAndPhoneInTableBookingResponse=1==p[a].showUsersEmailAndPhoneInTableBookingResponse,p[a].allowCommentInTableBooking=1==p[a].allowCommentInTableBooking,k=I+"/book-table/"+p[a].relListingId+"/"+h+"/"+p[a].maxTableBookingGuests+"/"+p[a].showUsersEmailAndPhoneInTableBookingResponse+"/"+p[a].allowCommentInTableBooking):"Book Tickets"==p[a].tonightsFeedButtonOptionName?k=I+"/book-tickets/"+p[a].relListingId+"/"+h:"See Details"==p[a].tonightsFeedButtonOptionName?k=b:"See Trailer"==p[a].tonightsFeedButtonOptionName&&(k=I+"//see-trailer/"+p[a].relListingId+"/"+h),m+="<a href='"+b+"' target='_blank' class='listing"+f+"'>",m+="<img class='main-img' src='"+v+"'></img>",m+="<div class='text-container'><span class='title'>"+p[a].name+"</span>",m+="<span class='description'>"+p[a].listingType1+"</span>",m+="</div>",m+="<button onclick=\"MynyteApi.goToFeedOption(event, '"+k+'\')" class="mn-listings-option-button">',m+=p[a].tonightsFeedButtonOptionName,m+="</button>",m+="</a>",a==p.length-1&&(m+="</div>",m+=g.html,n==s-1&&(m+="</div>",m+=c.html,i.append(m).css({display:"block"})))}}}function o(){var e=Object.keys(l.items),t=e.length;m+="<div class='mn-listings-nav listings-"+t+"-item-container'>";for(var a=e,n=0,i=t;n<i;n++){var o=a[n],r=(l.items[o],0==n?" active":""),c=l.items[o][0].iconClass;m+="<div onclick=\"MynyteApi.selectListingsNavItem('"+o+'\');" data-mn-nav-label-type="'+o+'" class="mn-listings-nav-listing'+r+'">',m+="<i class='fa "+c+"'></i>",m+="<span class='nav-listing-label'>"+o+"s</span>",m+="<span class='nav-listing-tri'></span>",m+="</div>",n==i-1&&(m+="</div><div class='listings-container' style='height: "+p+"px;'>",s())}}var l=t,r=e.imageSize||"small",m="",p=$(".mynyte-listings").height()-180,c={html:"<div class='mn-listings-footer'><span>Stay up to date with <b>MyNyte</b></span> <img src='https://www.mynyte.co.uk/sneak-preview/img/logo.png' /></div>"};m+={html:"<div class='mn-listings-header'><span><b>What's On &amp; About</b> in Bedford</span> <img src='https://www.mynyte.co.uk/sneak-preview/img/logo.png' /></div><span class='scrollbar'></span>"}.html,MynyteApi.selectListingsNavItem=function(e){n(e)},o()}console.log(e);var n,s=e.feedType;switch(e.feedType){case"menuDisplay":n=$(".mynyte-menu-display"),e.menuDisplayImgAlt="Log into MyNyte to book tables and make your evening plans",e.menuDisplayTranscriptNote="<b>Book Tables with ease</b>, and find out what's going on in town...",e.menuDisplayImgSrc="https://www.mynyte.co.uk/sneak-preview/img/logo.png",e.menuItemCategoryIdString=e.menuItemCategoryIdString||"0",e.menuItemClickable=e.menuItemClickable||!1;break;case"offersFeed":n=$(".mynyte-offers-display");break;default:n=$(".mynyte-listings")}var i=e.elem||n,l={offersFeed:"getOffersFeed",menuDisplay:"getMenuItems",listingsFeed:"getBusinessesByBusinessType"},p={listingsFeed:{_profileId:e._profileId||0,businessTypesString:e.businessTypesString||"All",_townId:e._townId||1,limit:e.limit||5},menuDisplay:{_businessId:T,menuType:e.menuType||"takeaway",menuItemCategoryIdString:e.menuItemCategoryIdString||"0"}},c={_businessId:T};console.log(s,l,p),o({className:"Profile",action:l[s],data:p[s]||c,existingVars:e,successCallback:function(e){var a=e.successData,n=e.existingVars;if("offersFeed"==s){a=a.items;var o=$(".mynyte-listings").height()-34,l="<div class='header'>MyNyte Offers</div><span class='scrollbar'></span><div class='listings-container' style='height: "+o+"px;'>";for(d=0;d<a.length;d++){var p="default-offer.jpg"==a[d].currentOfferCoverPhotoName?"":"<img class='main-img' src='https://www.mynyte.co.uk/sneak-preview/img/user_images/cover_photo/"+a[d].currentOfferCoverPhotoName+"'></img>",c="default-offer.jpg"==a[d].currentOfferCoverPhotoName?"":" with-image";a[d].endDateTimeArr=a[d].endDateTime.split(" "),l+="<div class='listing with-image"+c+"'>",l+=p,l+="<div class='text-container'><span class='title'>"+a[d].name+"</span>",l+="<span class='description'>"+a[d].description+"</span>",l+="<span class='offer-end'>Ends: "+a[d].endDateTimeArr[0]+"</span>",l+="</div></div>"}l+="</div>",i.append(l).css({display:"block"})}else if("menuDisplay"==s){a=a.items,console.log(a);var y={};1==n.menuItemClickable&&(r({class:"menu-item-detail"}),console.log("show"),MynyteApi.showMenuItem=function(e){console.log(e),console.log($(e).parent(".text-container"));var t=$(e).parent(".text-container"),a=t.find(".title").html(),n=t.find(".description").html(),s=t.data("image-url")?"https://www.mynyte.co.uk/"+x+"/sneak-preview/img/user_images/catalogue_item_photo/"+t.data("image-url"):null;if($(".mynyte-popup.menu-item-detail").find("h4").html(a),void 0!==n&&$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find(".menu-item-description").html(n),void 0!==s&&null!=s){var i=$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("p.menu-item-description");$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("img").attr("src",s),$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("img").show(),i.hasClass("with-image")||$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("p.menu-item-description").addClass("with-image")}else console.log("yo"),$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("img").hide(),$(".mynyte-popup.menu-item-detail").find(".mn-popup-body").find("p.menu-item-description").removeClass("with-image");m({speed:"fast"})});var l="<div class='container-header'>See our Menu</div>";l+="<div class='container-dummy'>";for(var d=0;d<a.length;d++)if(void 0===y[a[d].menuItemCategoryName]&&(y[a[d].menuItemCategoryName]=[]),d==a.length-1)for(var u=0;u<a.length;u++)if(y[a[u].menuItemCategoryName].push({name:a[u].Name,price:a[u].Price,description:a[u].Description,imageURL:a[u].imageURL}),u==a.length-1)for(var g in y)if(y.hasOwnProperty(g)){l+="<div class='listing listing-menu-item'>",l+="<div class='header'>"+g+"<span class='listing-menu-item-open'>+</span></div>",l+="<div class='body'>";for(var f=0;f<y[g].length;f++){var h=1==n.menuItemClickable?" onclick='MynyteApi.showMenuItem(this);'":"",v=1==n.menuItemClickable?" menu-item-clickable":"",b=""!=y[g][f].imageURL&&null!=y[g][f].imageURL?' data-image-url="'+y[g][f].imageURL+'"':"";l+="<div class='text-container'"+b+">",l+="<span class='title"+v+"'"+h+">"+y[g][f].name+"</span>",l+="\x3c!--<span class='options'>Options</span>--\x3e",l+="<span class='price'>£ "+y[g][f].price+"</span>",l+="<span class='description"+v+"'"+h+">"+y[g][f].description+"</span>",l+="</div>",f==y[g].length-1&&$(".header").on("click",function(){$(this).siblings(".body").addClass("open")})}l+="</div></div>"}l+="</div>",l+="<div class='container-footer'><span class='footer-transcript-note'>"+n.menuDisplayTranscriptNote+"</span><img class='mynyte-chat-logo' alt='"+n.menuDisplayImgAlt+"' src='"+n.menuDisplayImgSrc+"'/></div>",$(".mynyte-menu-display").addClass("mynyte-frame-container").append(l).css({display:"block"}),$("div.mynyte-menu-display").css("display","block"),$(".header").on("click",function(){var e=$(this),t=e.siblings(".body");t.hasClass("open")?(t.removeClass("open"),e.find(".listing-menu-item-open").html("+")):(t.addClass("open"),e.find(".listing-menu-item-open").html("-"))})}else"listingsFeed"==s&&(console.log(a),t(a))},errorCallback:function(){}})}function y(e){var t,a,n=e.type,s=e.currentBrand||"Mynyte",i=MynyteApi.pageVars.Globals[s],o={MyNyteTableBook:{html:"<img src='"+i["main-logo"]+"' alt='Book a restraurant table with MyNyte'/><span>Book a table with MyNyte</span>",elem:$("a.mynyte-table-book"),colourScheme:"dark",onclickFn:function(){window.open("https://www.mynyte.co.uk/#/app/profile/","mynyte-table-book-window","width=485,height=560")}},MyNyteEventEntryBook:{html:"<img src='"+i["main-logo"]+"' alt='Book event entry with MyNyte'/><span>Book event entry with MyNyte</span>",elem:$("a.mynyte-event-entry-book"),colourScheme:"dark",onclickFn:function(){window.open("https://www.mynyte.co.uk/#/app/profile/","mynyte-table-book-window","width=485,height=560")}}};a=e.elem||o[n].elem,t=e.onclickFn||o[n].onclickFn||null,colourScheme=e.colourScheme||o[n].colorScheme||"dark",a.html(o[n].html).css("display","block"),null!=t&&a.on("click",t)}function d(e){var t,a,n=e.type,s=e.colourScheme||"dark",i=e.brand||"Mynyte",o={TableBooking:{html:"<div class='container-header'>Book a Table with us through MyNyte</div><div class='container-dummy'><iframe allowtransparency='true' style='height: calc(100%); background: '"+("dark"==s?"#212121":"#f7f7f7")+";' src='"+MynyteApi.pageVars.Globals[i]["table-booking-frame-src"]+"'></iframe></div><div class='container-footer'><span class='footer-transcript-note'><b>Book Tables with ease</b>, and find out what's going on in town...</span><img class='mynyte-chat-logo' alt='Log into MyNyte to book tables and make your evening plans' src='"+MynyteApi.pageVars.Globals[i]["main-logo"]+"'/></div>",elem:$(".mynyte-table-booking"),onComplete:function(){$("div.mynyte-table-booking").addClass("mynyte-frame-container")}}};a=e.onComplete||o[n].onComplete||null,t=e.elem||o[n].elem,htmlText=o[n].html,console.log(o[n]),t.html(htmlText).css("display","block"),null!=a&&a()}function u(e){function t(){i==l.items.length-1?(MynyteApi.pageVars["Page Object"]["Business Items"]=r,g({viewType:n,successData:l,htmlString:m,htmlElem:p})):(e.i+=1,u(e))}function a(e,t,a){return e.split(t,a).join(t).length}var n=e.viewType,s=e._businessId,i=e.i,l=e.successData,r=e.businessItems,m=e.htmlString,p=e.htmlElem,c=e.viewModelProps||null,y=l.items[i];if(r[y._id]||(r[y._id]={}),r[y._id]._id=y._id,-1==y.metaName.indexOf("Arr[]")&&0!=y.metaName.indexOf("_")&&(null==c||c.indexOf(y.metaName)>-1))r[y._id][y.metaName]=y.metaValue,t();else if(-1==y.metaName.indexOf("Arr[]")&&0==y.metaName.indexOf("_Related")&&"Dropdown Selection"==n&&(null==c||c.indexOf(y.metaName)>-1))r[y._id][y.metaName]=y.metaValue,t();else if(-1==y.metaName.indexOf("Arr[]")&&0==y.metaName.indexOf("_Related")&&"Dropdown Selection"!=n){var d=y._id,f=y.metaName,h=y.metaName.replace(/-/g,"").replace("_","").replace(" Id",""),v=a(y.metaName,"-",1),b=a(y.metaName,"-",2),w=y.metaName.substring(v+1,b);o({existingVars:{thisItemId:d,thisItemMetaName:f,thisItemMetaNameFormatted:h},className:"BusinessEntity",action:"getBusinessEntityItemsMeta",data:{_businessId:s,_businessEntityItemId:y.metaValue},successCallback:function(e){if(MynyteApi.pageVars["Business Item Summary Displays"]&&MynyteApi.pageVars["Business Item Summary Displays"][0].specialProps&&MynyteApi.pageVars["Business Item Summary Displays"][0].specialProps[w]){console.log(w);var a=0;r[e.existingVars.thisItemId][e.existingVars.thisItemMetaNameFormatted]="";for(var n=0;n<e.successData.items.length;n++)console.log(w),MynyteApi.pageVars["Business Item Summary Displays"][0].specialProps[w].indexOf(e.successData.items[n].metaName)>-1&&(a>0&&(r[e.existingVars.thisItemId][e.existingVars.thisItemMetaNameFormatted]+=" - "),r[e.existingVars.thisItemId][e.existingVars.thisItemMetaNameFormatted]+=e.successData.items[n].metaValue,a+=1),n==e.successData.items.length-1&&t()}else r[e.existingVars.thisItemId][e.existingVars.thisItemMetaNameFormatted]=e.successData.items[0].metaValue,t()},errorCallback:function(){}})}else if(y.metaName.indexOf("Arr[]")>-1&&(null==c||c.indexOf(y.metaName)>-1)){var I=y.metaName.replace(" Arr[]","");r[y._id].Arrays=r[y._id].Arrays||{},r[y._id].Arrays[I]=r[y._id].Arrays[I]||[],r[y._id].Arrays[I].push(y.metaValue),t()}else t()}function g(e){var t=e.viewType,a=e.successData,n=e.htmlString,s=e.htmlElem;if(null!=a.items)for(var i=MynyteApi.pageVars["Page Object"]["Business Items"],o="Dropdown Selection"==t?"":" dropdown-selection-option",l=Object.keys(i),r=0,m=l.length;r<m;r++){var p=l[r],c="Dropdown Selection"==t?"li":"div";if(dataPropToDisplayString="","Dropdown Selection"==t){dataPropToDisplayString=" data-prop-to-display='";for(var y in i[p])"Arrays"!=y&&(dataPropToDisplayString+="<span>"+i[p][y]+" | </span>");dataPropToDisplayString+="'"}n+="<"+c+dataPropToDisplayString+" class='mynyte-business-items-summary-item"+o+"' data-item-ref='"+i[p]._id+"'>";for(var y in i[p]){var d=y.replace(/ /g,"-").toLowerCase();if("Arrays"!=y)n+="<div class='mynyte-label-container "+d+"-label-container'><label class='mynyte-label'>"+y+"</label>",n+="<span class='mynyte-label-detail'>"+i[p][y]+"</span></div>";else for(var u in i[p][y]){n+="<div class='mynyte-label-container "+y+"-label-container'><label class='mynyte-label'>"+u+"</label>",n+="<span class='mynyte-label-detail'><ul>";for(var g=0;g<i[p][y][u].length;g++)n+="<li>"+i[p][y][u][g]+"</li>";n+="</ul></span></div>"}}"Item Summary"==t?(n+="<a href='"+s.data("link")+p+"' class='action-button view-detail-button'>View Detail</a>",n+="</div>"):"Dropdown Selection"==t&&(n+="<a onclick='MynyteApi.addItemToFormFromDropdown(this);' class='action-button dropdown-option-select-button'>Select</a>"),n+="</"+c+">",r==m-1&&"Item Summary"==t?s.append(n).css({display:"block"}):r==m-1&&"Dropdown Selection"==t&&(console.log(s),s.append(n))}else n="<div>"+MynyteApi.pageVars["Business Item Summary Displays"][0].noItemsNote+"</div>","Item Summary"==t?s.append(n).css({display:"block"}):"Dropdown Selection"==t&&s.append(n)}function f(e,t){e.preventDefault();var a=$(t).data("name"),n=$("body").find(".dropdown-wrapper."+a+"-dropdown-wrapper").parents(".mynyte-popup-cover");n.hasClass("mynyte-popup-open")?n.removeClass("mynyte-popup-open"):n.addClass("mynyte-popup-open")}function h(e){var t,a,n=$(e).parents("li"),s=n.data("item-ref"),i=n.data("prop-to-display"),o=n.parents("ul.dropdown"),l=o.attr("class").split(/\s+/);$(e).parents(".mynyte-popup-open").removeClass("mynyte-popup-open"),$.each(l,function(e,n){n.indexOf("-dropdown")>-1&&(console.log(n.substr(0,n.indexOf("-dropdown"))),a=n.substr(0,n.indexOf("-dropdown")),t=$('.mynyte-form-input.mynyte-form-fake-input[data-name="'+a+'"]'),$(t).data("data-selected-item-ref")?$(t).data("selected-item-ref",s):$(t).attr("data-selected-item-ref",s),$(t).find(".selected-option-label").html(i))}),console.log(s)}var v=!1,b=!0,w=$(window).height(),I=document.getElementsByTagName("script"),k=(I[I.length-1].src,"undefined"!=typeof current_mynyte_env&&1==b?current_mynyte_env:"live"),M="undefined"!=typeof mynyte_db_environment&&1==b?mynyte_db_environment:k,N=null,x=null,A="localhost"==k&&1==b?"undefined"!=typeof local_root_prefix?local_root_prefix:"localhost/":"https://www.mynyte.co.uk",T=mynyte_business_id;N="staging"==k?"staging/":"",x="localhost"==k?"":k+"/",current_db_environment_file_url="localhost"==k?"":M+"/",console.log(k),MynyteApi.pageVars={},MynyteApi.pageVars.Globals={Mynyte:{"main-logo":"https://www.mynyte.co.uk/sneak-preview/img/logo.png","table-booking-frame-src":"https://www.mynyte.co.uk/"+N+"#/app/externalApi/bookTable/light/87/0"},Myday:{"main-logo":"https://www.mydayapp.co.uk/sneak-preview/img/logo.png"}},$("body").ontouchmove=function(e){v&&e.preventDefault()},$(document).on("focus","input.popup-input",function(e){$("body").addClass("fixfixed")}).on("blur","input.popup-input",function(e){$("body").removeClass("fixfixed")}),i("//ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js",function(){$(document).ready(function(){function e(){o({className:"BusinessEntity",action:"getBusinessEntityItemModel",data:{_businessId:$("div.mynyte-business-item-detail").data("bid"),businessEntityItemType:r.businessEntityItemType,extraFiltersString:"",_relatedViewModelId:r._relatedViewModelId},successCallback:function(e){a(e.successData)},errorCallback:function(e){}})}function t(e){function t(){for(var e=0;e<s.items.length;e++){var t=s.items[e],a=l[t.metaName],n=void 0!==a?a["Data Type"].toLowerCase():"string";console.log(t,t.metaName.indexOf("Arr[]")>-1),t.metaName.indexOf("Arr[]")>-1&&m[t.metaName]?m[t.metaName].push(t):t.metaName.indexOf("Arr[]")>-1?m[t.metaName]=[t]:"image"!=n?(p+="<div class='mynyte-label-container'><label class='mynyte-label'>"+t.metaName+"</label>",p+="<span class='mynyte-label-detail'>"+t.metaValue+"</span></div>"):"image"==n&&-1==t.metaName.indexOf("Arr[]")?(p+="<div class='mynyte-label-container'><label class='mynyte-label'>"+t.metaName+"</label>",p+="<span class='mynyte-label-detail with-image'><img src='"+r.internalDataUrl+"/images/"+t.metaValue+"' alt='' /></span></div>"):"image"==n&&t.metaName.indexOf("Arr[]")>-1&&(p+="<div class='mynyte-label-container'><label class='mynyte-label'>"+t.metaName+"</label>",p+="<span class='mynyte-label-detail with-image'><img src='"+r.internalDataUrl+"/images/"+t.metaValue+"' alt='' /></span></div>"),e==s.items.length-1&&$("div.mynyte-business-item-detail").append(p).css({display:"block"})}}function a(){for(var e in o)console.log(o),l[o[e].Name]=o[e];console.log(l),t()}function n(){for(var e=0;e<i.items.length;e++){var t=i.items[e]._propertyId,n=i.items[e].metaName,s=i.items[e].metaValue;o[t]||(o[t]={}),o[t][n]=s,e==i.items.length-1&&a()}}var s=e.successData,i=e.existingVars,o={},l={},m={};console.log(e);var p="";MynyteApi.pageVars["Page Object"]=s,n()}function a(e){console.log(e),o({className:"BusinessEntity",action:"getBusinessEntityItemsMeta",existingVars:e,data:{_businessId:$("div.mynyte-business-item-detail").data("bid"),_businessEntityItemId:r.businessEntityItemId},successCallback:function(e){t(e)},errorCallback:function(e){}})}if($("head").append('<link rel="stylesheet" href="'+A+"/"+x+'css/api-style.css" type="text/css" />'),$("head").append('<link rel="stylesheet" href="'+A+"/"+x+'css/ionicons.min.css" type="text/css" />'),$("head").append('<link rel="stylesheet" href="https://webfonts.creativecloud.com/c/69721a/1w;quicksand,2,WXp:W:n4,WXn:W:n7/l" type="text/css" />'),$("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" />'),$("a.mynyte-table-book").length&&c({elem:$(".mynyte-listings"),feedType:"offersFeed"}),$("a.mynyte-table-book").length&&y({type:"MyNyteTableBook"}),$("a.mynyte-event-entry-book").length&&y({type:"MyNyteEventEntryBook"}),$("div.mynyte-live-chat").length){var n=!1,s="<div class='container-header'>Live Chat through our MyNyte Account</div>";s+="<div class='container-dummy'><button class='chat-start' onclick='MynyteApi.chatStart()'>Start a Chat</button></div>",s+="<div class='container-footer'><span class='footer-transcript-note'>"+"<b>Keep a record of all chats</b>, and find out what's going on in town..."+"</span><img class='mynyte-chat-logo' alt='"+"Log into MyNyte to save transcripts, and get updates on the latest listings Bedford"+"' src='"+"https://www.mynyte.co.uk/sneak-preview/img/logo.png"+"'/></div>",$("div.mynyte-live-chat").html(s).css("display","block").addClass("mynyte-frame-container"),MynyteApi.chatStart=function(){var e=$("div.container-header").outerHeight()+$("div.container-footer").outerHeight()+2,t=$("div.mynyte-live-chat").hasClass("mn-dark")?"dark":"light",a=$("div.mynyte-live-chat").hasClass("mn-dark")?"#212121":"#f7f7f7",s="https://www.mynyte.co.uk/#/app/externalApi/liveChat/"+t+"/87/",i="height: calc(100% - "+e+"px); background: "+a+";";n?m({speed:"fast"}):$.get("https://www.mynyte.co.uk/templates/more-views/external-api-templates/live-chat-popup.php",function(e){$("body").append(e);var t=$(".mn-popup-header").outerHeight(),a=$(".mn-popup-footer").outerHeight(),o=t+a;$(".mn-popup-close").on("click",function(){p({})}),$(".mn-popup-body").css("max-height","calc("+(.9*w-o)+"px)"),$(".mynyte-popup .start-chat").on("click",function(e){e.preventDefault(),$("div.chat-dummy").replaceWith("<iframe allowtransparency='true' style='"+i+"' src='"+s+"'></iframe>"),p({})}),n=!0,m({speed:"slow"})})}}if($("div.mynyte-table-booking").length&&d({type:TableBooking,onComplete:function(){$("div.mynyte-table-booking").addClass("mynyte-frame-container")}}),$("div.mynyte-listings").length&&c({elem:$("div.mynyte-listings"),feedType:"listingsFeed",onComplete:function(){$("div.mynyte-listings").addClass("mynyte-frame-container")}}),$("div.mynyte-business-items-summary").length){var i=$("div.mynyte-business-items-summary");MynyteApi.pageVars["Page Object"]={},MynyteApi.pageVars["Business Item Summary Displays"]=[],MynyteApi.pageVars["Business Item Summary Displays"][0]={_businessId:i.data("bid"),businessEntityItemType:i.data("item-type"),businessEntityItemTypeLabel:i.data("item-sub-type").split(",")[0],businessEntityItemSubType:i.data("item-sub-type").split(",")[1],extraFiltersString:i.data("item-extra-filters"),noItemsNote:i.data("no-items-note")||"You currently have 0 "+i.data("item-sub-type").split(",")[1]+"s.",specialProps:i.data("special-prop"),internalDataUrl:i.data("internal-data")||"/"},o({className:"BusinessEntity",action:"getBusinessEntityItems",data:{_businessId:MynyteApi.pageVars["Business Item Summary Displays"][0]._businessId,businessEntityItemType:MynyteApi.pageVars["Business Item Summary Displays"][0].businessEntityItemType,extraFiltersString:MynyteApi.pageVars["Business Item Summary Displays"][0].extraFiltersString},successCallback:function(e){var t="Item Summary",a=MynyteApi.pageVars["Business Item Summary Displays"][0]._businessId,n=e.successData,s={},i="";MynyteApi.pageVars["Page Object"]["Business Items"]={},null!=n.items?u({viewType:t,_businessId:a,i:0,successData:n,businessItems:s,htmlString:i,htmlElem:$("div.mynyte-business-items-summary")}):g({viewType:t,successData:n,htmlString:i,htmlElem:$("div.mynyte-business-items-summary")})},errorCallback:function(e){}})}if($("div.mynyte-business-item-detail").length){var r=null;MynyteApi.pageVars["Page Object"]={},MynyteApi.pageVars["Business Item Detail Displays"]=[],MynyteApi.pageVars["Business Item Detail Displays"][0]={businessEntityItemId:window.location.href.indexOf("?_itemId")>-1?window.location.href.substr(window.location.href.indexOf("?_itemId=")+9,window.location.href.length):$("div.mynyte-business-item-detail").data("item-id"),businessEntityItemType:$("div.mynyte-business-item-detail").data("item-type")||"/",internalDataUrl:$("div.mynyte-business-item-detail").data("internal-data")||"/",_relatedViewModelId:$("div.mynyte-business-item-detail").data("viewmodel-id")},r=MynyteApi.pageVars["Business Item Detail Displays"][0],e()}if($("div.mynyte-new-business-item").length){var i=$("div.mynyte-new-business-item");MynyteApi.pageVars["Page Object"]={},MynyteApi.pageVars["New Business Item Forms"]=[],MynyteApi.pageVars["New Business Item Forms"][0]={_businessId:i.data("bid"),businessEntityItemType:i.data("item-type"),businessEntityItemTypeLabel:i.data("item-sub-type").split(",")[0],businessEntityItemSubType:i.data("item-sub-type").split(",")[1],_relatedViewModelId:i.data("viewmodel-id"),onUploadCompleteUrl:i.data("link"),internalDataUrl:i.data("internal-data")||"/"};var f="";if($("div.mynyte-new-business-item").data("item-extra-filters").length)for(var h=0;h<$("div.mynyte-new-business-item").data("item-extra-filters").split("||").length;h++){var v=$("div.mynyte-new-business-item").data("item-extra-filters").split("||")[h];f+="[["+v+"]]"}else f=null;o({className:"BusinessEntity",action:"getBusinessEntityItemModel",data:{_businessId:MynyteApi.pageVars["New Business Item Forms"][0]._businessId,businessEntityItemType:MynyteApi.pageVars["New Business Item Forms"][0].businessEntityItemType,extraFiltersString:f,_relatedViewModelId:MynyteApi.pageVars["New Business Item Forms"][0]._relatedViewModelId},successCallback:function(e){function t(){function e(){i+="<div class='mynyte-form-field-container mynyte-button-container'><button type='submit'>Add Item</button></div>",i+="</form>",MynyteApi.pageVars["Page Object"].Model=l,$("div.mynyte-new-business-item").append(i).css({display:"block"})}function t(t,a,s){var o=m[t],r=l[o].Name.replace(" Arr[]","s");i+="<div class='mynyte-form-field-container'><label class='mynyte-form-field-label'>"+r+a+"</label>",i+="<div class='mynyte-form-input-container'>"+s+"</div></div>",t<m.length-1?n(t+1):e()}function n(e){if(dataType.indexOf("INT")>-1&&null==a){var a=l[prop]["Related Property Type"]||"Business Item",n=l[prop]["Related Property Sub-Type"]||"Landlord",s=l[prop]["Related Property Label"]||"Business Entity Item",i=l[prop]["Related Property Sub-Label"]||"'Related Business Entity Specific Item Type'",r=["_id"];if(l[prop]["Related Property ViewModel Props"]){var m=l[prop]["Related Property ViewModel Props"].split(",");r=[];for(var p=0;p<m.length;p++)r.push(m[p])}var c={"Business Entity Item":{class:"BusinessEntity",action:"getBusinessEntityItems",data:{_businessId:MynyteApi.pageVars["New Business Item Forms"][0]._businessId,businessEntityItemType:a,extraFiltersString:"[["+i+"='"+n+"']]",_relatedViewModelId:"NULL"}}};o({className:c[s].class,action:c[s].action,data:c[s].data,successCallback:function(a){var n=MynyteApi.pageVars["New Business Item Forms"][0]._businessId,s=a.successData,i=l[prop].Name.substr(0==l[prop].Name.indexOf("_")?1:0,l[prop].Name.length).replace(" Id",""),o=l[prop].Name.replace(/ /g,"-").toLowerCase(),m='<div class="mynyte-popup-cover dropdown-wrapper price-dropdown-wrapper"><div class="mynyte-popup"><div class="mn-popup-body"><div class="dropdown-wrapper '+name.replace(/ /g,"-").toLowerCase()+'-dropdown-wrapper"><h4>Select a '+i+'</h4><i data-name="'+o+'" class="fa fa-times" onclick="return MynyteApi.toggleRelatedItemSelect(event, this)"></i><ul class="dropdown '+name.replace(/ /g,"-").toLowerCase()+'-dropdown"></ul></div></div></div>';MynyteApi.pageVars["Page Object"]["Business Items"]={},$("body").append(m),u({viewType:"Dropdown Selection",_businessId:n,i:0,successData:s,businessItems:{},htmlString:"",htmlElem:$(".dropdown."+o+"-dropdown"),viewModelProps:r}),inputString="<div data-name='"+o+"' class='mynyte-form-input mynyte-form-fake-input' onclick='return MynyteApi.toggleRelatedItemSelect(event, this)'><span class='selected-option-label'></span><button class='mynyte-form-select-toggler'><i class='fa fa-chevron-down'></i></button></div>",inputString+="",t(e,isReqLabel,inputString)},errorCallback:function(e){console.log("error: ",errorData)}})}else dataType.indexOf("VARCHAR")>-1?(inputString="<input name = '"+name+"' class='mynyte-form-input mynyte-form-text-input"+isReq+"' type='text' "+maxLen+minLen+" />",""!=maxLen&&(inputString+="<span class='input-maxlength-note'>"+l[prop]["Max Length"]+" Char Max</span>")):dataType.indexOf("INT")>-1&&null!=a?(inputString="<input name='"+name+"' class='mynyte-form-input mynyte-form-text-input"+isReq+"' type='number' "+maxLen+minLen+" />",""!=maxLen&&(inputString+="<span class='input-maxlength-note'>"+l[prop]["Max Length"]+" Char Max</span>")):"DATE"==dataType?inputString="<div data-name='"+l[prop].Name+"' class='mynyte-form-input mynyte-form-fake-input"+isReq+"'><button class='mynyte-form-datepicker'></button></div>":"TIME"==dataType?inputString="<div data-name='"+l[prop].Name+"' class='mynyte-form-input mynyte-form-fake-input"+isReq+"'><button class='mynyte-form-timepicker'></button></div>":"IMAGE"==dataType&&(MynyteApi.imageUploadFileTypeCheck=function(e){function t(a){var n=new FileReader;n.readAsDataURL(e.files[a]),n.onload=function(s){function i(s){var i=$('<div class="img-container"></div>'),o=$("<img />"),l=$(e).parent("span").find(".mynyte-image-input-images");o.attr("src",n.result),o.attr("style","margin-top: "+s),i.append(o),l.append(i),a<e.files.length-1&&t(a+1)}var o=new Image;o.onload=function(){var e=this.width;i((e-this.height)/e*100/2+"%")},o.src=n.result},n.onerror=function(e){console.log("Error: ",e)}}t(0)},inputString="<span><input onchange='MynyteApi.imageUploadFileTypeCheck(this)' name = '"+name+"' class='mynyte-form-input mynyte-form-image-input"+isReq+"' type='file' accept='image/*' "+maxLen+minLen+" multiple/><span class='mynyte-image-input-images'></span></span>"),t(e,isReqLabel,inputString)}function s(e){var t=m[e],a=(l[t]["Data Type"],l[t].Name.toLowerCase().replace(/ /g,"-")),i=(l[t]["Is Required"],l[t]["Is Required"],l[t]["Max Length"]&&l[t]["Max Length"],l[t]["Min Length"]&&l[t]["Min Length"],l[t]["Related Property Type"],l[t]["Related Property Sub-Type"],!!a.indexOf("arr[]"));i&&arrays[a.replace("-arr[]","")]?arrays[a.replace("-arr[]","")].push(l[t]):i&&(arrays[a.replace("-arr[]","")]=[l[t]]),e<m.length-1&&!i?(p.push(l[t]),s(e+1)):e<m.length?s(e+1):e==m.length-1&&(p.push(arrays),console.log(p),n(0))}for(var i="<form action='#' name='mynyte-business-item-add-form' onsubmit='return MynyteApi.addBusinessItem();'>",l={},r=0;r<a.items.length;r++){l[a.items[r]._propertyId]||(l[a.items[r]._propertyId]={});if(l[a.items[r]._propertyId][a.items[r].metaName]=a.items[r].metaValue,r==a.items.length-1){var m=Object.keys(l),p=[];s(0)}}}var a=e.successData;MynyteApi.addBusinessItem=function(){function e(e,t){if("add"==e)switch(t){case"input":$('input[name="'+s+'"]').addClass("mynyte-input-error");break;case"div":$('div[data-name="'+s+'"]').addClass("mynyte-input-error");break;case"textarea":$('textarea[name="'+s+'"]').addClass("mynyte-input-error")}else if("remove"==e)switch(t){case"input":$('input[name="'+s+'"]').removeClass("mynyte-input-error");break;case"div":$('div[data-name="'+s+'"]').removeClass("mynyte-input-error");break;case"textarea":$('textarea[name="'+s+'"]').removeClass("mynyte-input-error")}}function t(){d<u-1?p+=",":d==u-1&&(void 0!==MynyteApi.pageVars["New Business Item Forms"][0].businessEntityItemSubType&&(p+=", [['"+MynyteApi.pageVars["New Business Item Forms"][0].businessEntityItemTypeLabel+"', '"+MynyteApi.pageVars["New Business Item Forms"][0].businessEntityItemSubType+"']]"),p+=", [['Date Created', CURDATE()]], [['Time Created', CURTIME()]]")}var a=MynyteApi.pageVars["Page Object"].Model;MynyteApi.pageVars["Page Object"]["Has Error"]=!1;for(var n in a){var s=a[n].Name.toLowerCase().replace(/ /g,"-"),i=null;if($('input[name="'+s+'"]').length){console.log($('input[name="'+s+'"]').val());var r=$('input[name="'+s+'"]');if("file"==r.attr("type")){if(a[n].Value=[],r[0].files)for(var m=0;m<r[0].files.length;m++)a[n].Value.push(r[0].files[m].name)}else a[n].Value=$('input[name="'+s+'"]').val();i="input"}else $('div[data-name="'+s+'"]').length?(s=s.toLowerCase().replace(/ /g,"-"),a[n].Value=$('div[data-name="'+s+'"]').data("selected-item-ref"),i="div"):$('textarea[name="'+s+'"]').length&&(a[n].Value=$('textarea[name="'+s+'"]').val(),i="textarea");""==a[n].Value||void 0===a[n].Value?(a[n].error="Please fill in a value for this field",e("add",i),MynyteApi.pageVars["Page Object"]["Has Error"]=!0,console.log(a)):(a[n].error=null,e("remove",i))}if(MynyteApi.pageVars["Page Object"].Model=a,!MynyteApi.pageVars["Page Object"]["Has Error"]){for(var a=MynyteApi.pageVars["Page Object"].Model,p="",c=new FormData($('form[name="mynyte-business-item-add-form"]')[0]),y=Object.keys(a),d=0,u=y.length;d<u;d++)if(a[y[d]].Value.constructor===Array)for(var g=0;g<a[y[d]].Value.length;g++)p+="[['"+a[y[d]].Name+"', '"+a[y[d]].Value[g]+"']]",g==a[y[d]].Value.length-1?t():p+=",";else p+="[['"+a[y[d]].Name+"', '"+a[y[d]].Value+"']]",t();o({className:"BusinessEntity",action:"addBusinessEntityItem",data:{_businessId:MynyteApi.pageVars["New Business Item Forms"][0]._businessId,businessEntityItemName:MynyteApi.pageVars["New Business Item Forms"][0].businessEntityItemType,nameValuePairString:p},successCallback:function(e){e.successData},errorCallback:function(e){}}),l({className:"Image",action:"uploadImage",data:c,successCallback:function(e){e.successData},errorCallback:function(e){}})}return console.log(a),!1},t()},errorCallback:function(e){}})}})}),MynyteApi.processContact=function(e){$.ajax({url:"https://www.mynyte.co.uk/sneak-preview/data/extApi/Profile.php?action=registerContact",method:"POST",data:JSON.stringify(e),dataType:"json"}).success(function(e){console.log(e)}).error(function(e){console.log(e)})},MynyteApi.closePopup=function(e){p(e)},MynyteApi.dataConnect=function(e){o(e)},MynyteApi.createFeed=function(e){c(e)},MynyteApi.createButton=function(e){y(e)},MynyteApi.createPortal=function(e){d(e)},MynyteApi.toggleRelatedItemSelect=function(e,t){f(e,t)},MynyteApi.addItemToFormFromDropdown=function(e){h(e)}},MynyteApi()}();