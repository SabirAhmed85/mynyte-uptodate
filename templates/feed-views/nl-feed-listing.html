<ion-view view-title="Search Result Listing | {{rootScope.pageTitle}} in Bedford on myNyte.co.uk" class="grey_bg nl-feed-listing">
  	<ion-content>
        <div>
            <div class="page-loading-container"
                ng-show="pageLoading">
                <ion-spinner icon="lines" class="spinner-red"></ion-spinner>
                <span class="loading-text">Loading ...</span>
            </div>
            <div id="detailedContent" class="trans"
                ng-class="{'isVisible': !pageLoading}">
                <div id="detailedContent-inner" class="detailedContent-inner">
                    <div id="listing-info">
                        
                        <img id="listing-cover-image" src="/sneak-preview/img/user_images/cover_photo/default.jpg"
                            ng-src="{{rootScope.assetsFolderUrl}}/img/user_images/cover_photo/{{listing.currentCoverPhotoName}}"
                            ng-click="seePhoto('CoverPhoto')"></img>
                        <img id="listing-image" class="profile-listing-image" src="/sneak-preview/img/user_images/profile_photo/default.jpg"
                            ng-src="{{rootScope.assetsFolderUrl}}/img/user_images/profile_photo/{{listing.currentProfilePhotoName}}"
                            ng-if="listing.listingType != 'Movie' && listing.listingType != 'Event'"
                            ng-click="seePhoto('ProfilePhoto')">
                    </div>
                    
                    <div id="detailed-mainText"
                      ng-class="{'person': listing.listingType == 'Person'}">
                        <div class="header-panel">
                              <span class="business-type-panel">
                                <button class="btn-red btn"
                                  ng-if="listing.listingType != 'Person' && (rootScope.user.isBusiness == '0' || !rootScope.userLoggedIn)">
                                    <!--<i class="ion-ios-people"
                                      ng-click="shareListing($event, listing);"></i>-->
                                      <i class="ion-email-unread"
                                        ng-click="pinListingToMsg(listing, $event);"></i>
                                      <span ng-if="!rootScope.userLoggedIn"
                                        ng-click="pinListingToMsg(listing, $event);">Send to Friends</span>
                                      <i class="ion-thumbsup"
                                        ng-if="rootScope.userLoggedIn"
                                        ng-class="{'active': listing.like == '3'}"
                                        ng-click="attemptToLikeOrFollowListing('Like', listing, $event);"></i>
                                </button>
                              </span>
                              <span class="title-panel">
                                <span id="listing-date-details"
                                  ng-if="listing.listingType == 'Event'">
                                  <span ng-if="listing.weekday != null">Every {{listing.weekday}} until {{listing.lastDate}}</span>
                                  <span ng-if="listing.weekday == null">{{listing.dateDisplay}}</span>
                                </span>
                                <h3 id="listing-name">{{listing.name}}</h3>
                                <span id="listing-description">
                                  <span ng-repeat="listingType in listing.listingTypes">
                                    <span ng-show="listingType != listing.listingTypes[0]">&amp;</span> {{listingType}}
                                  </span> <span ng-if="listing.town != null">| {{listing.town}}</span>
                                </span>
                                <span id="listing-location"
                                  ng-show="listing.listingType == 'Event'"
                                  ui-sref="app.feed.nlfeedListing({_listingId:listing._relatedBusinessId, listingType:'Business'})">
                                  <i class="ion-home icon-left"></i>
                                  <span class="text">{{listing.businessName}}, {{listing.addressLine1}}, {{listing.postcode}}</span>
                                  <i class="ion-chevron-right icon-right"></i>
                                </span>
                              </span>
                              <span class="button-panel">
                                    <button class="enquiry"
                                      ng-click="sendMessage();"
                                      ng-class="{'disabled': messageDisabled}">
                                        <i class="ion-email"></i>
                                        <span ng-show="listing.isBusiness == '1' || listing.listingType == 'Event' || listing.listingType == 'Movie'">Enquiry</span>
                                        <span ng-show="listing.isBusiness != '1' && listing.listingType != 'Event' && listing.listingType != 'Movie'">Message</span>
                                    </button>
                                    <button class="centre"
                                      ng-show="listing.listingType != 'Event' && listing.listingType != 'Offer' && listing.listingType != 'Movie'"
                                      ng-click="attemptToLikeOrFollowListing('Follow', listing, $event);">
                                        <i
                                          ng-class="{'ion-person': listing.follow, 'ion-person-add': !listing.follow}"></i><span ng-show="!listing.follow">Follow</span><span ng-show="listing.follow">Unfollow</span>
                                    </button>
                                    <button class="follow centre" 
                                      ng-show="listing.listingType == 'Event' || listing.listingType == 'Offer' || listing.listingType == 'Movie'"
                                      ng-click="attemptToLikeOrFollowListing('Watch', listing, $event);">
                                        <i
                                          ng-class="{'active': listing.watch == '2', 'ion-eye-disabled': listing.watch == '2','ion-eye': listing.watch != '2'}"></i><span ng-show="listing.watch != '2'">Watch</span><span ng-show="listing.watch == '2'">Unwatch</span>
                                    </button>
                                    <button class="navigate" 
                                      ng-show="listing.listingType != 'Offer'"
                                      ng-click="seePhotos(listing)">
                                        <i class="ion-images"></i><span>Photos</span>
                                    </button>
                              </span>
                              
                              <a class="option-panel"
                                ng-click="goToSeeTrailer();"
                                ng-show="listing.listingTypes.indexOf('Movie') != -1">
                                <i class="ion-ios-videocam"></i>
                                <span>
                                    See Trailer
                                </span>
                              </a>
                              <a class="option-panel guestlist-option double-line"
                                ng-click="goToBookTickets();"
                                ng-class="{
                                    'disabled': !listing.isGuestListAllowed || listing.isGuestListMaxReached,
                                    'show': listing.listingType == 'Event'}">
                                <i class="ion-clipboard"></i>
                                <span class="text-container">
                                  <span class="main">Get on the Guestlist</span>
                                  <span class="note"
                                    ng-if="!listing.isGuestListAllowed && !listing.isGuestListMaxReached && !listing.isPastEvent">Not accepting guestlist bookings.</span>
                                  <span class="note"
                                    ng-if="listing.isGuestListMaxReached">Guestlist fully booked!</span>
                                  <span class="note"
                                    ng-show="listing.isGuestListAllowed">Now accepting guestlist bookings.</span>
                                  <span class="note"
                                    ng-if="listing.isPastEvent">This event has taken place already.</span>
                                </span>
                              </a>
                              <a class="option-panel double-line"
                                ng-click="goToBookTable();"
                                ng-show="listing.listingTypes.indexOf('Restaurant') != -1"
                                ng-class="{'disabled': !listing.isAcceptingTableBookings}">
                                <i class="ion-fork"></i>
                                <span class="text-container">
                                  <span class="main">Book A Table</span>
                                  <span class="note"
                                    ng-show="listing.isAcceptingTableBookings == '0'">Currently not accepting bookings.</span>
                                  <span class="note"
                                    ng-show="listing.isAcceptingTableBookings == '1'">Now accepting bookings.</span>
                                </span>
                              </a>
                              <a class="option-panel"
                                ng-show="listing.listingTypes.indexOf('Restaurant') != -1"
                                ng-class="{'double-line': !listing.showCarteMenu, 'disabled': !listing.showCarteMenu}"
                                ng-click="goToSeeMenu('Carte');">
                                <i class="ion-ios-paper"></i>
                                <span class="text-container">
                                  <span class="main"
                                    ng-class="{'without-note': listing.showCarteMenu}">A la carte Menu</span>
                                  <span class="note"
                                    ng-show="!listing.showCarteMenu">Menu currently hidden</span>
                                </span>
                                <i class="ion-email-unread dir-arrow"
                                  ng-show="listing.showCarteMenu && rootScope.userLoggedIn && rootScope.user.isBusiness == 0"
                                  ng-click="rootScope.pinListingToMessage($event, listing, 'BusinessesA la Carte Menu', 1); $event.stopPropagation();"></i>
                              </a>
                              <a class="option-panel"
                                ng-show="listing.listingTypes.indexOf('Takeaway') != -1"
                                ng-class="{'double-line': !listing.showTakeawayMenu, 'disabled': !listing.showTakeawayMenu}"
                                ng-click="goToSeeMenu('Takeaway');">
                                <i class="ion-ios-paper"></i>
                                <span class="text-container">
                                  <span class="main"
                                    ng-class="{'without-note': listing.showTakeawayMenu}">Takeaway Menu <span ng-show="listing.isAcceptingOnlineOrders">/ Order Food</span></span>
                                  <span class="note"
                                    ng-show="!listing.showTakeawayMenu">Menu currently hidden</span>
                                </span>
                                <i class="ion-email-unread dir-arrow"
                                  ng-show="listing.showTakeawayMenu && rootScope.userLoggedIn && rootScope.user.isBusiness == 0"
                                  ng-click="rootScope.pinListingToMessage($event, listing, 'BusinessesTakeaway Menu', 2); $event.stopPropagation();"></i>
                              </a>
                              <!--
                              <span class="option-panel"
                                ng-show="listing.listingTypes.indexOf('Taxi Firm') != -1"
                                ng-click="goToBookTaxi();"
                                ng-class="{'disabled': !listing.isAcceptingTaxiBookings, 'double-line': !listing.isAcceptingTaxiBookings}">
                                <i class="ion-android-car"></i>
                                <span class="text-container">
                                  <span class="main">Book a taxi</span>
                                  <span class="note"
                                    ng-show="listing.isAcceptingTaxiBookings">Now accepting taxi bookings.</span>
                                  <span class="note"
                                    ng-show="!listing.isAcceptingTaxiBookings">Currently not accepting taxi bookings.</span>
                                </span>
                              </span>
                            -->
                              <a class="option-panel"
                                ui-sref="app.seeBusinessesItems({searchType: searchType, _businessTypeId: _businessTypeId, _listingId: _listingId, listingType: listingType, _businessId: listing.relListingId, itemType: 'UpcomingEvents', listingName: listing.name})"
                                ng-show="listing.listingTypes.indexOf('Nightclub') != -1 || listing.listingTypes.indexOf('Bar') != -1">
                                <i class="ion-calendar"></i>
                                <span>Upcoming Events ({{listing.totalUpcomingEvents}})</span>
                                <i class="ion-email-unread dir-arrow"
                                  ng-if="rootScope.userLoggedIn && rootScope.user.isBusiness == '0' && listing.totalUpcomingEvents > 0"
                                  ng-click="rootScope.pinListingToMessage($event, listing, 'BusinessesEvents', null); $event.stopPropagation();"></i>
                              </a>
                              <a class="option-panel"
                                ui-sref="app.seeBusinessesItems({searchType: searchType, _businessTypeId: _businessTypeId, _listingId: _listingId, listingType: listingType, _businessId: listing.relListingId, itemType: 'Offers', listingName: listing.name})"
                                ng-if="listing.listingType != 'Person' && listing.listingType != 'Movie'">
                                <i class="ion-social-usd"></i>
                                <span ng-if="listing.listingType != 'Event'">Offers ({{listing.totalOffers}})</span>
                                <span ng-if="listing.listingType == 'Event'">Deals on the Night ({{listing.totalOffers}})</span>
                                <i class="ion-email-unread dir-arrow"
                                  ng-if="rootScope.userLoggedIn && rootScope.user.isBusiness == '0' && listing.totalOffers > 0"
                                  ng-click="rootScope.pinListingToMessage($event, listing, 'EventsOffers', null); $event.stopPropagation();"></i>
                              </a>
                          </div>

                        <h2 class="nlfeed-listing-h2">
                            <span>Info/ About</span>
                            <!--<span class="active">Main Feed</span>
                            <span class="last">Follower Posts</span>
                            -->
                            <span id="feed-triangle"></span>
                        </h2>
                        <div class="inner-text">
                            <div class="description-wrapper"
                                ng-if="listing.description != null && listing.description != ''">
                                {{listing.description}}
                            </div>
                            <div
                                ng-if="listing.listingType == 'Business'">
                                <div class="address-wrapper"
                                    ng-if="listing.addressLine1 != '' && listing.postcode != '' && listing.addressLine1 != null && listing.postcode != null">
                                    <h4>Address</h4>
                                    <span>{{listing.addressLine1}}, </span>
                                    <span ng-if="listing.addressLine2 != null && listing.addressLine2 != ''">{{listing.addressLine2}}, </span>
                                    <span>{{listing.postcode}}</span>
                                </div>
                                <div class="opening-times-wrapper">
                                    <h4>Opening Times</h4>
                                    <span class="line"
                                        ng-repeat="time in listing.openingTimes">
                                        {{time[0]}}:
                                        <span ng-if="time[1] != null && time[2] != null">
                                            {{time[1]}} - {{time[2]}}
                                        </span>
                                        <span ng-if="time[1] == null || time[2] == null">
                                            Closed
                                        </span>
                                    </span>
                                </div>
                            </div>
                            <div
                                ng-if="listing.listingType == 'Event'">
                                <div class="event-dress-code-wrapper"
                                    ng-if="listing.dressCode != null && listing.dressCode != ''">
                                    <h4>Dress Code</h4>
                                    <span>{{listing.dressCode}}</span>
                                </div>
                                <div class="event-dress-code-wrapper"
                                    ng-if="listing.extraInfo != null && listing.extraInfo != ''">
                                    <h4>Extra Info.</h4>
                                    <span>{{listing.extraInfo}}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="feed-side side" ng-include="'templates/shared-partials/offers-sidebar.html'"></div>
                </div>
            </div>
        </div>
    </ion-content>
    <div class="feed-side side" ng-include="'templates/shared-partials/profile-info-sidebar.html'"></div>
</ion-view>
